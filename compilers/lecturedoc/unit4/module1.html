
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Scanning με το Plex &#8212; Test 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/mytheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Κανονικές Εκφράσεις (regular expressions)" href="../unit3/module1.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
<div class="pageheader">
     <img src=../_static/banner.gif alt="mistral"/>
     <div>
        <h4>Τμήμα Πληροφορικής - Ιόνιο Πανεπιστήμιο</h4>
        <h2>Μεταγλωττιστές</h2>
        <h4>Εαρινό Εξάμηνο 2018-19</h4>        
        <h5>Μ.Στεφανιδάκης</h5>
      </div>    
</div>


  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="scanning-plex">
<h1>Scanning με το Plex<a class="headerlink" href="#scanning-plex" title="Permalink to this headline">¶</a></h1>
<p>Η <strong>λεκτική ανάλυση</strong> (scanning) χρησιμοποιείται για να χωρίσουμε ένα κείμενο εισόδου (σε κάποια γλώσσα προγραμματισμού ή εφαρμογής) σε <strong>σύμβολα</strong> (tokens). Σε κανονικές συνθήκες, απαιτούμε <strong>όλο</strong> το κείμενο να μπορεί να αναγνωριστεί ως σύμβολα: αν υπάρχει μέρος του κειμένου που δεν ταιριάζει με κανένα σύμβολο, θέλουμε να παράγεται σφάλμα εκτέλεσης.</p>
<p>Αν και μπορούμε να αναλύσουμε το κείμενο εισόδου με πολλαπλές regular expressions, στα επόμενα θα χρησιμοποιήσουμε το module <code class="docutils literal notranslate"><span class="pre">plex</span></code>. Αυτό <strong>δεν ανήκει</strong> στη στάνταρ βιβλιοθήκη της Python, έτσι πρέπει να το κατεβάσουμε και να το εγκαταστήσουμε στο σύστημά μας.</p>
<div class="section" id="id1">
<h2>Οδηγίες εγκατάστασης<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Εάν το module <code class="docutils literal notranslate"><span class="pre">plex</span></code> δεν υπάρχει στο σύστημά σας, θα πρέπει να το εγκαταστήσετε από το <a class="reference external" href="https://pypi.org/project/plex3/">PyPi</a> (ή το ανεπίσημο <a class="reference download internal" download="" href="../_downloads/3f27a6f37529af263454d54b2431769d/Plex-2.0.1.tar.gz"><code class="xref download docutils literal notranslate"><span class="pre">Python3</span> <span class="pre">patch</span></code></a>)</p>
<p>Υπάρχουν πολλοί τρόποι εγκατάστασης:</p>
<ol class="arabic simple">
<li><p>Αν έχετε το <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> (για την Python3, π.χ. από το package <code class="docutils literal notranslate"><span class="pre">python3-virtualenv</span></code>) δίνετε:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">your</span> <span class="n">virtual</span> <span class="n">env</span> <span class="n">folder</span><span class="o">&gt;</span>
<span class="n">virtualenv</span> <span class="n">venv</span> <span class="o">-</span><span class="n">p</span> <span class="n">python3</span> <span class="p">(</span><span class="n">ή</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">virtualenv</span> <span class="n">venv</span> <span class="o">-</span><span class="n">p</span> <span class="n">python3</span><span class="p">)</span>
<span class="n">source</span> <span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">plex3</span> <span class="p">(</span><span class="n">ή</span> <span class="n">το</span> <span class="n">link</span> <span class="n">του</span> <span class="n">ανεπίσημου</span> <span class="n">patch</span> <span class="n">αντί</span> <span class="n">για</span> <span class="n">plex3</span><span class="p">)</span>
</pre></div>
</div>
<p>Στη συνέχεια μπορείτε να τρέξετε τα δικά σας προγράμματα, αρκεί πάντα το virtual environment να είναι ενεργοποιημένο (με το <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">venv/bin/activate</span></code>.</p>
<ol class="arabic simple" start="2">
<li><p>Μπορείτε να χρησιμοποιήσετε την εντολή του pip κατευθείαν στο συστημά σας (χωρίς virtualenv) αν έχετε δικαιώματα superuser. Εναλλακτικά προσθέστε <code class="docutils literal notranslate"><span class="pre">--user</span></code> για τοπική εγκατάσταση.</p></li>
<li><p>Τέλος, μπορείτε απλά να αποσυμπιέσετε το ανεπίσημο patch του plex στον φάκελο όπου τρέχετε τα παραδείγματά σας. Φροντίστε όμως τα αρχεία σας να έχουν <strong>διαφορετικά ονόματα</strong> από εκείνα που περιέχονται στο patch!</p></li>
</ol>
</div>
<div class="section" id="id2">
<h2>Απλό παράδειγμα χωρίς έλεγχο λαθών<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Μην ξεχάσετε να φορτώσετε το module plex:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plex</span>
</pre></div>
</div>
<p>Ως πρώτο παράδειγμα, θέλουμε να κατασκευάσουμε έναν scanner που αναγνωρίζει τα σύμβολα <code class="docutils literal notranslate"><span class="pre">123</span></code> και <code class="docutils literal notranslate"><span class="pre">abc</span></code> (και <strong>τίποτα αλλο</strong>!). Αρχικά κατασκευάζουμε ένα <code class="docutils literal notranslate"><span class="pre">plex.Lexicon</span></code>, μια λίστα από ζευγάρια <code class="docutils literal notranslate"><span class="pre">((pattern,action)</span></code>. Το <code class="docutils literal notranslate"><span class="pre">pattern</span></code> είναι ένα πρότυπο αναγνώρισης (όπως οι regular expressions που έχουμε ήδη δει) και το <code class="docutils literal notranslate"><span class="pre">action</span></code> καθορίζει τι θα επιστρέψει ο scanner όταν ταιριάξει κείμενο με το αντίστοιχο pattern.</p>
<p>Στο παράδειγμα που ακολουθεί, θέλουμε με την εμφάνιση του abc να επιστρέφεται το string <code class="docutils literal notranslate"><span class="pre">&quot;ABC_TOKEN&quot;</span></code>, ενώ με την εμφάνιση του 123 να επιστρέφεται το string <code class="docutils literal notranslate"><span class="pre">&quot;123_TOKEN&quot;</span></code>. Επίσης, θέλουμε να αγνοούμε ένα η περισσότερα κενα, tab και newlines (ως action χρησιμοποιείται η ειδική σταθερά <code class="docutils literal notranslate"><span class="pre">plex.IGNORE</span></code>). Το πώς κατασκευάζεται το pattern θα το δούμε αργότερα.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
        <span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">),</span><span class="s2">&quot;ABC_TOKEN&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">),</span><span class="s2">&quot;123_TOKEN&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t\n</span><span class="s2">&quot;</span><span class="p">)),</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>
        <span class="p">])</span>
</pre></div>
</div>
<p>Στη συνέχεια, δημιουργούμε ένα αντικείμενο της κλάσης <code class="docutils literal notranslate"><span class="pre">plex.Scanner</span></code> για συγκεκριμένο λεξικό και αρχείο:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex1.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>
</pre></div>
</div>
<p>Αμέσως μετά, μπορούμε να καλέσουμε επαναληπτικά τη μέθοδο <code class="docutils literal notranslate"><span class="pre">read()</span></code> του αντικειμένου scanner. Αυτή η μέθοδος επιστρέφει για κάθε token που αναγνωρίζει ένα ζευγάρι <code class="docutils literal notranslate"><span class="pre">(value-returned-from-action,matched-text)</span></code>. Όταν δεν υπάρχουν άλλα σύμβολα στο αρχείο εισόδου (end-of-text, EOT), επιστρέφεται το ζευγάρι <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">'')</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>     <span class="c1"># reached EOT</span>

        <span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>
</pre></div>
</div>
<p>Το συνολικό πρόγραμμα έχει ως εξής:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A sample app using plex module.</span>
<span class="sd">No error checking is done here.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plex</span>

<span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">),</span><span class="s2">&quot;ABC_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">),</span><span class="s2">&quot;123_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t\n</span><span class="s2">&quot;</span><span class="p">)),</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>
	<span class="p">])</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex1.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	<span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>	<span class="c1"># reached EOT</span>
	
	<span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>	
		
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Φυσικά, με το λεξικό που χρησιμοποιείται, το αρχείο εισόδου πρέπει να αποτελείται <strong>μόνο</strong> από 123 και abc, π.χ. το
<a class="reference download internal" download="" href="../_downloads/bd80fa2689c22aaed472865dd4564d01/plex1.txt"><code class="xref download docutils literal notranslate"><span class="pre">plex1.txt</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Μπορείτε να κατεβάσετε <a class="reference external" href="https://gist.github.com/mixstef/25166fe36f89aed4acee">όλα τα αρχεία python και txt</a>.</p>
</div>
</div>
<div class="section" id="exception-handling">
<h2>Προσθέτοντας έλεγχο λαθών (exception handling)<a class="headerlink" href="#exception-handling" title="Permalink to this headline">¶</a></h2>
<p>Όταν στο αρχείο εισόδου βρεθεί κείμενο που δεν ταιριάζει σε κανένα σύμβολο, δημιουργείται σφάλμα (exception) του τύπου <code class="docutils literal notranslate"><span class="pre">plex.errors.PlexError</span></code>. Μπορούμε να αναγνωρίσουμε την κατάσταση αυτή με τη δομή <code class="docutils literal notranslate"><span class="pre">try:</span> <span class="pre">...</span> <span class="pre">except:</span> <span class="pre">...</span></code> της Python
και να βρούμε σε ποιο σημείο του κειμένου συνέβει το σφάλμα, μέσω της μεθόδου <code class="docutils literal notranslate"><span class="pre">position()</span></code> του scanner:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A sample app using plex module.</span>
<span class="sd">Simple error catching and reporting.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plex</span>

<span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;abc&quot;</span><span class="p">),</span><span class="s2">&quot;ABC_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">),</span><span class="s2">&quot;123_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t\n</span><span class="s2">&quot;</span><span class="p">)),</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>
	<span class="p">])</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex2.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>	<span class="c1"># &quot;fname&quot; as optional 3rd arg, to be returned</span>
					<span class="c1"># by scanner.position()</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		
	<span class="k">except</span> <span class="n">plex</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">PlexError</span><span class="p">:</span>
		<span class="n">fname</span><span class="p">,</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">position</span><span class="p">()</span>	<span class="c1"># lineno is 1-based, charno is 0-based </span>
		<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Scanner Error at line {} char {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">break</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>	<span class="c1"># reached EOT</span>


	<span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>

		
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Εφαρμόζεται στο <a class="reference download internal" download="" href="../_downloads/5e348f86abe50a355d29b2556f8f0b1c/plex2.txt"><code class="xref download docutils literal notranslate"><span class="pre">plex2.txt</span></code></a>.</p>
</div>
<div class="section" id="plex-patterns">
<h2>Plex patterns<a class="headerlink" href="#plex-patterns" title="Permalink to this headline">¶</a></h2>
<p>Αν S, S1, S2 είναι strings, και Β, Ε χαρακτήρες, μπορούν να κατασκευαστούν τα εξής patterns ταιριάσματος:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Str(S)</p></td>
<td><p>ταιριάζει το string S</p></td>
</tr>
<tr class="row-even"><td><p>Str(S1,S2,..)</p></td>
<td><p>ταιριάζει ένα από τα S1, S2, ..</p></td>
</tr>
<tr class="row-odd"><td><p>Any(S)</p></td>
<td><p>ταιριάζει κάθε μονό χαρακτήρα του S</p></td>
</tr>
<tr class="row-even"><td><p>AnyBut(S)</p></td>
<td><p>ταιριάζει κάθε χαρακτήρα που δεν ανήκει στο S</p></td>
</tr>
<tr class="row-odd"><td><p>AnyChar</p></td>
<td><p>ταιριάζει κάθε μονό χαρακτήρα (και το newline)</p></td>
</tr>
<tr class="row-even"><td><p>Empty</p></td>
<td><p>ταιριάζει το κενό string</p></td>
</tr>
<tr class="row-odd"><td><p>Bol,Eol,Eof</p></td>
<td><p>ταιριάζει στην αρχή/τέλος γραμμής και τέλος κειμένου</p></td>
</tr>
<tr class="row-even"><td><p>Range(“BE..”)</p></td>
<td><p>ταιριάζει περιοχές από το Β έως το Ε κ.ο.κ</p></td>
</tr>
</tbody>
</table>
<p>Επίσης, αν P, P1, P2 είναι patterns που έχουν ήδη κατασκευαστεί, μπορούν να γίνουν οι εξής συνδυασμοί:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>P1+P2 ή Seq(P1,P2)</p></td>
<td><p>το P1 ακολουθούμενο από το P2</p></td>
</tr>
<tr class="row-even"><td><p>P1|P2 ή Alt(P1,P2)</p></td>
<td><p>είτε το P1 είτε το P2 (εναλλαγή)</p></td>
</tr>
<tr class="row-odd"><td><p>Opt(P)</p></td>
<td><p>0 ή 1 φορά το P (προαιρετικό)</p></td>
</tr>
<tr class="row-even"><td><p>Rep(P)</p></td>
<td><p>0 ή περισσότερες φορές το P</p></td>
</tr>
<tr class="row-odd"><td><p>Rep1(P)</p></td>
<td><p>1 ή περισσότερες φορές το P</p></td>
</tr>
<tr class="row-even"><td><p>NoCase(P)  Case(P)</p></td>
<td><p>το P, αγνοώντας (ή λαμβάνοντας υπ’όψη) κεφαλαία-μικρά</p></td>
</tr>
</tbody>
</table>
<p>(για την πλήρη τεκμηρίωση του plex δείτε το <a class="reference external" href="https://pythonhosted.org/plex/">https://pythonhosted.org/plex/</a>)</p>
</div>
<div class="section" id="id3">
<h2>Κανόνες Ταιριάσματος<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Στην περίπτωση που υπάρχουν εναλλακτικές επιλογές ταιριάσματος, το plex εφαρμόζει με τη σειρά τους εξής κανόνες:</p>
<ol class="arabic simple">
<li><p>Προτιμάται η επιλογή που επιτυγχάνει το μακρύτερο ταίριασμα (αυτή που ταιριάζει περισσότερους χαρακτήρες).</p></li>
<li><p>Εάν οι επιλογές ταιριάζουν τον ίδιο αριθμό χαρακτήρων, επιλέγεται η πρώτη, με τη σειρά δήλωσης στο λεξικό.</p></li>
</ol>
</div>
<div class="section" id="id4">
<h2>Ο κανόνας του μακρύτερου ταιριάσματος<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Γιατί ταιριάζει το <code class="docutils literal notranslate"><span class="pre">tomcat</span></code> αντί του <code class="docutils literal notranslate"><span class="pre">tom</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A sample app using plex module.</span>
<span class="sd">Checking the &quot;longest match wins&quot; rule.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plex</span>

<span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;tom&quot;</span><span class="p">),</span><span class="s2">&quot;TOM_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">),</span><span class="s2">&quot;CAT_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;tomcat&quot;</span><span class="p">),</span><span class="s2">&quot;TOMCAT_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t\n</span><span class="s2">&quot;</span><span class="p">)),</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>
	<span class="p">])</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex3.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>	

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		
	<span class="k">except</span> <span class="n">plex</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">PlexError</span><span class="p">:</span>
		<span class="n">fname</span><span class="p">,</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">position</span><span class="p">()</span>	
		<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Scanner Error at line {} char {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">break</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>

	<span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>
			
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Εφαρμόζεται στο <a class="reference download internal" download="" href="../_downloads/c8614e40eef6a4dcdd0a8341c29c53b2/plex3.txt"><code class="xref download docutils literal notranslate"><span class="pre">plex3.txt</span></code></a>.</p>
</div>
<div class="section" id="id5">
<h2>Αγνοώντας κείμενο με βάση το μακρύτερο ταίριασμα<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Δουλεύει για εύρεση tokens με μήκος &gt; 1.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A sample app using plex module.</span>
<span class="sd">Using the &quot;longest match wins&quot; rule to match only a word (len&gt;1)</span>
<span class="sd">and ignore everything else.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plex</span>

<span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">),</span><span class="s2">&quot;123_TOKEN&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">AnyChar</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>
	<span class="p">])</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex4.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>	

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		
	<span class="k">except</span> <span class="n">plex</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">PlexError</span><span class="p">:</span>
		<span class="n">fname</span><span class="p">,</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">position</span><span class="p">()</span>	
		<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Scanner Error at line {} char {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">break</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>


	<span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>
	
	
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Εφαρμόζεται στο <a class="reference download internal" download="" href="../_downloads/026ff027437ce613f896a1b4888dcfd0/plex4.txt"><code class="xref download docutils literal notranslate"><span class="pre">plex4.txt</span></code></a>.</p>
</div>
<div class="section" id="id6">
<h2>Σε ταίριασμα ίδιου μήκους προηγείται ό,τι δηλώθηκε πρώτα<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>Αν το identifier rule είναι πρώτο, δεν θα ταιριάξουμε ποτέ τα keywords!</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A sample app using plex module.</span>
<span class="sd">Demonstrating the &quot;from equal matches, the topmost wins&quot; rule.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plex</span>

<span class="c1"># define some pattern constructs here, to increase readability</span>
<span class="n">letter</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;AZaz&quot;</span><span class="p">)</span>
<span class="n">digit</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;09&quot;</span><span class="p">)</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">letter</span> <span class="o">+</span> <span class="n">plex</span><span class="o">.</span><span class="n">Rep</span><span class="p">(</span><span class="n">letter</span> <span class="o">|</span> <span class="n">digit</span><span class="p">)</span>
<span class="n">space</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">keyword</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;if&quot;</span><span class="p">,</span><span class="s2">&quot;then&quot;</span><span class="p">,</span><span class="s2">&quot;else&quot;</span><span class="p">,</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>


<span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
	<span class="p">(</span><span class="n">keyword</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">TEXT</span><span class="p">),</span>	<span class="c1"># plex.TEXT returns as token id the matched text</span>
	<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;IDENTIFIER&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">space</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>
	<span class="p">])</span>

<span class="c1"># if lexicon is defined as follows, keywords cannot be found!</span>
<span class="c1">#lexicon = plex.Lexicon([</span>
<span class="c1">#	(name, &quot;IDENTIFIER&quot;),</span>
<span class="c1">#	(keyword,plex.TEXT),	</span>
<span class="c1">#	(space,plex.IGNORE)</span>
<span class="c1">#	])</span>


<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex5.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>	

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		
	<span class="k">except</span> <span class="n">plex</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">PlexError</span><span class="p">:</span>
		<span class="n">fname</span><span class="p">,</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">position</span><span class="p">()</span>	
		<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Scanner Error at line {} char {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">break</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>

	<span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>
		
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>Εφαρμόζεται στο <a class="reference download internal" download="" href="../_downloads/13e29b1d1903b3ead6f172861ff3337b/plex5.txt"><code class="xref download docutils literal notranslate"><span class="pre">plex5.txt</span></code></a>.</p>
</div>
<div class="section" id="single-line">
<h2>Αγνοώντας single-line σχόλια<a class="headerlink" href="#single-line" title="Permalink to this headline">¶</a></h2>
<p>Το ζητούμενο είναι η κατασκευή scanner που να αναγνωρίζει</p>
<ul class="simple">
<li><p>identifiers</p></li>
<li><p>ακέραιες σταθερές</p></li>
<li><p>σταθερές floating point (στις μορφές xx.yy και .yy, σε οποιοδήποτε αριθμό ψηφίων x και y)</p></li>
<li><p>σταθερές hex (στη μορφή 0x…)</p></li>
<li><p>τα keywords if, the, else, end</p></li>
<li><p>τους τελεστές + - * / = &lt; &gt; (τελεστές ενός χαρακτήρα)</p></li>
</ul>
<p>και να αγνοεί:</p>
<ul class="simple">
<li><p>newline, tab, space</p></li>
<li><p>οτιδήποτε ακολουθεί // μέχρι το τέλος της γραμμής</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A sample app using plex module.</span>
<span class="sd">A simple language token extractor, with single line comment support.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plex</span>

<span class="c1"># define some pattern constructs here, to increase readability</span>
<span class="n">letter</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;AZaz&quot;</span><span class="p">)</span>
<span class="n">digit</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;09&quot;</span><span class="p">)</span>
<span class="n">hexdigit</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">NoCase</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;af09&quot;</span><span class="p">))</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">letter</span> <span class="o">+</span> <span class="n">plex</span><span class="o">.</span><span class="n">Rep</span><span class="p">(</span><span class="n">letter</span> <span class="o">|</span> <span class="n">digit</span><span class="p">)</span>
<span class="n">space</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">keyword</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;if&quot;</span><span class="p">,</span><span class="s2">&quot;then&quot;</span><span class="p">,</span><span class="s2">&quot;else&quot;</span><span class="p">,</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>
<span class="n">intnumber</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span>
<span class="n">floatnumber</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Opt</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">digit</span><span class="p">))</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span>	<span class="c1"># xx.yy, .yy but not xx.</span>
<span class="n">hexnumber</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">hexdigit</span><span class="p">)</span>
<span class="n">operator</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot;+-*/=&lt;&gt;&quot;</span><span class="p">)</span>
<span class="n">singlecomment</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">AnyBut</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

<span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
	<span class="p">(</span><span class="n">intnumber</span><span class="p">,</span><span class="s2">&quot;INTCONST&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">floatnumber</span><span class="p">,</span><span class="s2">&quot;FLOATCONST&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">hexnumber</span><span class="p">,</span><span class="s2">&quot;HEXCONST&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">keyword</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">TEXT</span><span class="p">),</span>	
	<span class="p">(</span><span class="n">operator</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">TEXT</span><span class="p">),</span>
	<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;IDENTIFIER&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">space</span><span class="o">|</span><span class="n">singlecomment</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>
	<span class="p">])</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex6.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>	

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		
	<span class="k">except</span> <span class="n">plex</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">PlexError</span><span class="p">:</span>
		<span class="n">fname</span><span class="p">,</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">position</span><span class="p">()</span>	
		<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Scanner Error at line {} char {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">break</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>

	<span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>
			
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Εφαρμόζεται στο <a class="reference download internal" download="" href="../_downloads/c1becbcae78517bbd4d81ef05d4ddef6/plex6.txt"><code class="xref download docutils literal notranslate"><span class="pre">plex6.txt</span></code></a>.</p>
</div>
<div class="section" id="multiple-line">
<h2>Αγνοώντας multiple-line σχόλια /* … */<a class="headerlink" href="#multiple-line" title="Permalink to this headline">¶</a></h2>
<p>Αν τα block σχόλια τερματίζονται με έναν μόνο χαρακτήρα, τότε μπορούμε να εφαρμόσουμε μια λύση όπως στο προηγούμενο. Στην περίπτωση που ο τερματισμός των σχολίων απαιτεί μια ακολουθία χαρακτήρων (όπως το <code class="docutils literal notranslate"><span class="pre">*/</span></code>), είναι πιο εύκολο να χρησιμοποιήσουμε ξεχωριστό state όσο βρισκόμαστε μέσα στο σχόλιο. Εκτός από την απλότητα, το ξεχωριστό state επιτρέπει το χειρισμό nested σχολίων (π.χ. με έναν counter που παρακολουθεί το επίπεδο nesting -δεν υλοποιείται όμως στο επόμενο παράδειγμα) και δεν απαιτεί την αποθήκευση πολλών χαρακτήρων από τον scanner μέχρι το τέλος του σχολίου:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">A sample app using plex module.</span>
<span class="sd">A simple language token extractor, with single line comment support</span>
<span class="sd">and block comment support (via scanner states).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">plex</span>

<span class="c1"># define some pattern constructs here, to increase readability</span>
<span class="n">letter</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;AZaz&quot;</span><span class="p">)</span>
<span class="n">digit</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;09&quot;</span><span class="p">)</span>
<span class="n">hexdigit</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">NoCase</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s2">&quot;af09&quot;</span><span class="p">))</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">letter</span> <span class="o">+</span> <span class="n">plex</span><span class="o">.</span><span class="n">Rep</span><span class="p">(</span><span class="n">letter</span> <span class="o">|</span> <span class="n">digit</span><span class="p">)</span>
<span class="n">space</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot; </span><span class="se">\t\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">keyword</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;if&quot;</span><span class="p">,</span><span class="s2">&quot;then&quot;</span><span class="p">,</span><span class="s2">&quot;else&quot;</span><span class="p">,</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>
<span class="n">intnumber</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span>
<span class="n">floatnumber</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Opt</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">digit</span><span class="p">))</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">digit</span><span class="p">)</span>	<span class="c1"># xx.yy, .yy but not xx.</span>
<span class="n">hexnumber</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep1</span><span class="p">(</span><span class="n">hexdigit</span><span class="p">)</span>
<span class="n">operator</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Any</span><span class="p">(</span><span class="s2">&quot;+-*/=&lt;&gt;&quot;</span><span class="p">)</span>
<span class="n">singlecomment</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;//&quot;</span><span class="p">)</span><span class="o">+</span><span class="n">plex</span><span class="o">.</span><span class="n">Rep</span><span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">AnyBut</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

<span class="c1"># the scanner lexicon - constructor argument is a list of (pattern,action ) tuples</span>
<span class="n">lexicon</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Lexicon</span><span class="p">([</span>
	<span class="p">(</span><span class="n">intnumber</span><span class="p">,</span><span class="s2">&quot;INTCONST&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">floatnumber</span><span class="p">,</span><span class="s2">&quot;FLOATCONST&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">hexnumber</span><span class="p">,</span><span class="s2">&quot;HEXCONST&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">keyword</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">TEXT</span><span class="p">),</span>	
	<span class="p">(</span><span class="n">operator</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">TEXT</span><span class="p">),</span>
	<span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;IDENTIFIER&quot;</span><span class="p">),</span>
	<span class="p">(</span><span class="n">space</span><span class="o">|</span><span class="n">singlecomment</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">),</span>
	<span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;/*&quot;</span><span class="p">),</span><span class="n">plex</span><span class="o">.</span><span class="n">Begin</span><span class="p">(</span><span class="s1">&#39;BlockCommentState&#39;</span><span class="p">)),</span>	<span class="c1"># switch to block comment state</span>
	
	<span class="n">plex</span><span class="o">.</span><span class="n">State</span><span class="p">(</span><span class="s1">&#39;BlockCommentState&#39;</span><span class="p">,[</span>
	  <span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">Str</span><span class="p">(</span><span class="s2">&quot;*/&quot;</span><span class="p">),</span><span class="n">plex</span><span class="o">.</span><span class="n">Begin</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)),</span>	<span class="c1"># back to normal state</span>
	  <span class="p">(</span><span class="n">plex</span><span class="o">.</span><span class="n">AnyChar</span><span class="p">,</span><span class="n">plex</span><span class="o">.</span><span class="n">IGNORE</span><span class="p">)</span>		<span class="c1"># this works due to the longest match rule</span>
	<span class="p">])</span>
	  
	<span class="p">])</span>

<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;plex7.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">plex</span><span class="o">.</span><span class="n">Scanner</span><span class="p">(</span><span class="n">lexicon</span><span class="p">,</span><span class="n">fp</span><span class="p">)</span>	

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
	
	<span class="k">try</span><span class="p">:</span>
		<span class="n">token</span><span class="p">,</span><span class="n">matched</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
		
	<span class="k">except</span> <span class="n">plex</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">PlexError</span><span class="p">:</span>
		<span class="n">fname</span><span class="p">,</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">position</span><span class="p">()</span>	
		<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Scanner Error at line {} char {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lineno</span><span class="p">,</span><span class="n">charno</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">break</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">token</span><span class="p">:</span> <span class="k">break</span>

	<span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="p">,</span><span class="n">matched</span><span class="p">)</span>
			
<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Εφαρμόζεται στο <a class="reference download internal" download="" href="../_downloads/2056a7502124cc1b4bf09d5797ced4ea/plex7.txt"><code class="xref download docutils literal notranslate"><span class="pre">plex7.txt</span></code></a>.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Περιεχόμενα</a></h3>
  <ul>
<li><a class="reference internal" href="#">Scanning με το Plex</a><ul>
<li><a class="reference internal" href="#id1">Οδηγίες εγκατάστασης</a></li>
<li><a class="reference internal" href="#id2">Απλό παράδειγμα χωρίς έλεγχο λαθών</a></li>
<li><a class="reference internal" href="#exception-handling">Προσθέτοντας έλεγχο λαθών (exception handling)</a></li>
<li><a class="reference internal" href="#plex-patterns">Plex patterns</a></li>
<li><a class="reference internal" href="#id3">Κανόνες Ταιριάσματος</a></li>
<li><a class="reference internal" href="#id4">Ο κανόνας του μακρύτερου ταιριάσματος</a></li>
<li><a class="reference internal" href="#id5">Αγνοώντας κείμενο με βάση το μακρύτερο ταίριασμα</a></li>
<li><a class="reference internal" href="#id6">Σε ταίριασμα ίδιου μήκους προηγείται ό,τι δηλώθηκε πρώτα</a></li>
<li><a class="reference internal" href="#single-line">Αγνοώντας single-line σχόλια</a></li>
<li><a class="reference internal" href="#multiple-line">Αγνοώντας multiple-line σχόλια /* … */</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      
      
    </div>

    

    
  </body>
</html>